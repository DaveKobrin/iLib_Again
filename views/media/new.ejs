<%- include ('../partials/head.ejs') %> 
<div class="container-fluid">
    <div class="row p-5">
        <form action="/media" method="POST">
              
            <div class="row mb-3">
                <div class="col-sm-6">
                    <div class="input-group">
                        <label class="input-group-text" for="upc">UPC</label>
                        <input id="inpUpc" class="form-control" type="text" name="upc" id="upc"/>
                        <input id="btnLookup" class="btn bg-ilib-primary text-ilib-primary" type="submit" value="lookup" formaction="/media/edit" formmethod="post"/>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="input-group">
                        <label class="input-group-text" for="title">Title</label>
                        <input class="form-control" type="text" name="title" id="title"/>
                    </div>
                </div>
            </div>
            <div class="row mb-3">
                <div class="col-sm-6">
                    <div class="input-group">
                        <label class="input-group-text" for="creator_name">Creator Name</label>
                        <input class="form-control" type="text" name="creator_name" id="creator_name"/>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="input-group">
                        <label class="input-group-text" for="creator_type">Creator Type</label>
                        <input class="form-control" name="creator_type" id="creator_type" autocomplete="off" onkeypress="if (event.keyCode == 13) return false;" />
                        <select id="sel-creator-type" class="btn bg-ilib-primary text-ilib-primary"
                            onchange="var textbox = document.getElementById('creator_type'); textbox.value = (this.selectedIndex == -1 ? '' : this.options[this.selectedIndex].value); textbox.select(); textbox.dispatchEvent(new Event('change'));"
                            onclick="this.selectedIndex = -1;">
                            <% let opt=''; %>
                            <% if(dropdownData) { %>
                                <% for ( const el of dropdownData.creatorType ) { %>
                                    <option value="<%= el %>"><%= el %></option>
                                    <% }} %>  
                        </select>
                    </div>    
                </div>
            </div>

            <div class="row mb-3">
                <div class="input-group">
                    <label class="input-group-text" for="cover_img">Image Link</label>
                    <input class="form-control" type="textarea" name="cover_img" id="cover_img"/>
                </div>
            </div>
            
            <div class="row mb-3">
                <div class="input-group">
                    <label class="input-group-text" for="cover_alt">Image Alt Desc.</label>
                    <input class="form-control" type="text" name="cover_alt" id="cover_alt"/>
                </div>
            </div>

            <div class="row mb-3">
                <div class="col-sm-6">
                    <div class="input-group">
                        <label class="input-group-text" for="format">Format</label>
                        <input class="form-control" name="format" id="format" autocomplete="off" onkeypress="if (event.keyCode == 13) return false;" />
                        <select id="sel-format" class="btn bg-ilib-primary text-ilib-primary"
                            onchange="var textbox = document.getElementById('format'); textbox.value = (this.selectedIndex == -1 ? '' : this.options[this.selectedIndex].value); textbox.select(); textbox.dispatchEvent(new Event('change'));"
                            onclick="this.selectedIndex = -1;">
                            <% opt=''; %>
                            <% if(dropdownData) { %>
                                <% for ( const el of dropdownData.format ) { %>
                                    <option value="<%= el %>"><%= el %></option>
                                    <% }} %>  
                        </select>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="input-group">
                        <label class="input-group-text" for="location">location</label>
                        <input class="form-control" name="location" id="location" autocomplete="off" onkeypress="if (event.keyCode == 13) return false;" />
                        <select id="sel-location" class="btn bg-ilib-primary text-ilib-primary"
                            onchange="var textbox = document.getElementById('location'); textbox.value = (this.selectedIndex == -1 ? '' : this.options[this.selectedIndex].value); textbox.select(); textbox.dispatchEvent(new Event('change'));"
                            onclick="this.selectedIndex = -1;">
                            <% opt=''; %>
                            <% if(dropdownData) { %>
                                <% for ( const el of dropdownData.location ) { %>
                                    <option value="<%= el %>"><%= el %></option>
                                    <% }} %>  
                        </select>
                    </div>
                </div>
            </div>
            <div class="row mb-3">
                <div class="input-group">
                    <label class="input-group-text" for="tags">Tags</label>
                    <input class="form-control" type="text" name="tags" id="tags" placeholder="separate with comma, space"/>
                </div>
            </div>

            <div class="row mb-3">
                <div class="input-group">
                    <label class="input-group-text" for="desc">Description</label>
                    <input class="form-control" type="textarea" name="desc" id="desc"/>
                </div>
            </div>
            <input class=" btn bg-ilib-primary text-ilib-primary" type="submit" value="Submit"/>
        </form>
    </div>
</div>
</div>
<script>
const inpUpc = document.querySelector('#inpUpc');
inpUpc.addEventListener('change', (e)=>{
    const btnLookup = document.querySelector('#btnLookup');
    // const dataProxy = document.querySelector('#dataProxy');
    // const entry = JSON.parse(dataProxy.dataset.entry);
    btnLookup.setAttribute('formaction', `/media/edit/${e.target.value}`); 
});
</script>
<%- include ('../partials/foot.ejs') %> 
